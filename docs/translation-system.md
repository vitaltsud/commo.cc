# Система перевода: ядро на английском, строки — на локальном языке

## Принцип

- **Код и шаблоны** — на английском: ключи переводов в коде всегда на английском и читаются как исходные фразы (например `header.signIn` → "Sign in with Google" в en).
- **Отображение** — на выбранном языке: одна и та же ключ подставляется из файла локали (pl, ru, uk и т.д.); если перевода нет — показывается английская строка из `en.json`.

Итог: разработка ведётся по английским ключам и `en.json`, а пользователь видит текст на своём языке.

---

## Структура

```
messages/
  en.json   ← эталон (все ключи, все строки на английском)
  pl.json
  ru.json
  uk.json
  de.json
  es.json
  it.json
  ...
```

- **Ключи** — точечная нотация, только латиница, по смыслу на английском: `header.signIn`, `home.heroTitle`, `settings.communicationLanguagesHelp`.
- **Значения в en.json** — итоговый английский текст для продакшена; он же используется как fallback при отсутствии перевода в другой локали.

---

## Правила для разработчиков

1. **Новая строка в UI**  
   - Придумать ключ на английском (например `booking.confirmButton`).  
   - Добавить его в **en.json** с английским значением.  
   - Добавить перевод в остальные локали (pl, ru, uk, …) или оставить — тогда покажется английская строка.

2. **В коде** — только ключ, без хардкода текста:
   ```tsx
   <button>{t("booking.confirmButton")}</button>
   ```
   Не писать:
   ```tsx
   <button>Confirm</button>
   ```

3. **Эталон** — всегда `en.json`. Перед мержем фичи проверять, что все новые ключи есть в `en.json` и при необходимости — в других локалях.

4. **Имена ключей** — существительные/глаголы на английском, без аббревиатур и «магических» сокращений: `profile.speaks`, а не `profile.s`.

---

## Fallback

- При запросе `t("some.key")`:
  1. Берётся значение из текущей локали (например pl).
  2. Если в pl этого ключа нет или значение пустое — берётся значение из **en.json**.
  3. Если и в en нет — возвращается сам ключ (чтобы было видно, что перевод пропущен).

Так ядро сайта остаётся на английском: при незаполненном переводе пользователь видит английский текст.

---

## Работа переводчиков

- Открыть `en.json` — там полный список ключей и эталонный английский текст.
- В своей локали (например `pl.json`) скопировать структуру и заменить только значения на польский; ключи не менять.
- Новые ключи из последнего `en.json` можно найти сравнением с предыдущей версией или по списку ключей (см. ниже).

---

## Список ключей (для скриптов и переводчиков)

- Все ключи определяются структурой **en.json** (вложенные объекты → ключи вида `section.subsection.key`).
- Скрипт вывода всех ключей:
  ```bash
  node scripts/list-i18n-keys.js
  ```
  Выводит по одному ключу в строке (dot-notation). Удобно для сверки с другими локалями или импорта в CAT.

---

## ## Plural (множественное число)

Чтобы фразы звучали естественно (1 отзыв / 2 отзыва / 5 отзывов), используется **plural** по правилам CLDR.

- В JSON ключ может быть **объектом** с формами: `one`, `few`, `many`, `other` (и при необходимости `zero`, `two`). Форма `other` обязательна — она подставляется, если для локали нет своей формы.
- В коде вызывается `t("profile.reviewsCount", { count: n })`. По текущей локали и числу выбирается форма (через `Intl.PluralRules`), затем в строку подставляется `{{count}}`.

Пример в en.json:

```json
"profile": {
  "reviewsCount": {
    "one": "{{count}} review",
    "other": "{{count}} reviews"
  }
}
```

В ru.json для русского (one / few / many / other):

```json
"reviewsCount": {
  "one": "{{count}} отзыв",
  "few": "{{count}} отзыва",
  "many": "{{count}} отзывов",
  "other": "{{count}} отзывов"
}
```

Интерполяция: в любой строке можно использовать `{{name}}`, `{{count}}` и т.д.; значения передаются вторым аргументом: `t("key", { count: 5, name: "Иван" })`.

---

## Резюме

| Что | Где | Язык |
|-----|-----|------|
| Ключи в коде | React/TS | Английские имена (header.signIn, home.heroTitle) |
| Эталонные строки | messages/en.json | Английский |
| Локализованные строки | messages/pl.json, ru.json, … | Локальный |
| Fallback при отсутствии перевода | lib/i18n | Английский (из en.json) |
| Plural | Объект one/few/many/other в JSON + t(key, { count }) | По правилам CLDR для каждой локали |

Так достигается «ядро и шаблоны на английском, все текстовые переменные — на локальном языке», с естественным plural по языку.
